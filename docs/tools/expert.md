# expert

Expert consultation and configuration. Actions: `consult` (get expert opinions), `configure` (customize expert settings).

## Usage

```json
{
  "name": "expert",
  "arguments": {
    "action": "consult",
    "roles": ["architect", "security"],
    "context": "Adding a REST API that accepts file uploads...",
    "question": "What security concerns should we address?"
  }
}
```

## Parameters

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| action | String | Yes | `consult` or `configure` |
| roles | Array[String] | For consult | Expert roles to consult |
| context | String | For consult | Code, design, or situation to analyze |
| question | String | No | Specific question for all experts |
| mode | String | No | `parallel` (default) or `debate` |
| config_action | String | For configure | `set`, `get`, `delete`, `list`, or `providers` |
| role | String | Conditional | Expert role for configure (required for `set`/`get`/`delete`) |
| prompt | String | No | Custom system prompt (for `set`) |
| provider | String | No | LLM provider (for `set`): `deepseek` or `gemini` |
| model | String | No | Custom model name (for `set`) |

### Available Expert Roles

| Role | Description |
|------|-------------|
| `architect` | System design, patterns, tradeoffs |
| `plan_reviewer` | Validate implementation plans before coding |
| `scope_analyst` | Identify missing requirements and edge cases |
| `code_reviewer` | Find bugs and code quality issues |
| `security` | Identify vulnerabilities and suggest hardening |

## Actions

### `consult` — Get expert opinions

**Single expert** — runs an agentic loop (reason → tool call → observe → iterate, max 100 iterations):
```json
{ "action": "consult", "roles": ["architect"], "context": "...", "question": "..." }
```

**Multiple experts** — uses council architecture:
```json
{ "action": "consult", "roles": ["code_reviewer", "security"], "context": "..." }
```

Council mode pipeline:
1. **Plan** — Coordinator assigns tasks to experts
2. **Execute** — Experts run in parallel (max 3 concurrent)
3. **Review** — Coordinator identifies consensus, conflicts, gaps
4. **Delta** — Up to 2 targeted follow-up rounds
5. **Synthesize** — Final combined output

Falls back to parallel independent consultations if council fails.

**MCP Sampling**: When no API keys are configured, experts can consult via the host client using MCP Sampling — no `DEEPSEEK_API_KEY` or `GEMINI_API_KEY` required.

**Concurrency**: Max 3 concurrent experts, 10-minute per-expert timeout, 15-minute council timeout.

### `configure` — Customize expert settings

Uses `config_action` sub-parameter:

**`set`** — Configure a role:
```json
{ "action": "configure", "config_action": "set", "role": "architect", "provider": "gemini" }
```

**`get`** — Show configuration:
```json
{ "action": "configure", "config_action": "get", "role": "architect" }
```

**`delete`** — Revert to defaults:
```json
{ "action": "configure", "config_action": "delete", "role": "code_reviewer" }
```

**`list`** — List all custom configurations:
```json
{ "action": "configure", "config_action": "list" }
```

**`providers`** — List available providers and models:
```json
{ "action": "configure", "config_action": "providers" }
```

## Errors

- **No LLM provider**: Set `DEEPSEEK_API_KEY` or `GEMINI_API_KEY`, or use MCP Sampling
- **Invalid role**: Must be one of the valid role keys
- **Timeout**: Consultations exceeding 15 minutes are cancelled

## See Also

- [**finding**](./finding.md): Manage findings generated by expert consultations
- [**session**](./session.md): Track LLM usage via `session(action="usage")`
- [**code**](./code.md): Experts use code intelligence tools internally
